#jpa 

## 컬렉션 래퍼
하이버네이트는 엔티티를 영속 상태로 만들 때 엔티티에 컬렉션이 있으면 컬렉션을 추적하고 관리할 목적으로 원본 컬렉션을 **하이버네이트가 제공하는 내장 컬렉션으로 변경**한다. 이를 컬렉션 래퍼라 한다.

> [!info]+ 
> 컬렉션의 class를 출력해보면 다음과 같이 반환된다.
> `org.hibernate.collection.internal.PersistentBag`

엔티티를 [[지연 로딩]]하면 [[프록시]] 객체를 사용해서 지연 로딩을 수행하지만 컬렉션은 컬렉션 래퍼가 지연 로딩을 처리해준다.

### 컬렉션에 FetchType.EAGER 사용 시 주의점
> [!caution]+ 
> 1. 컬렉션을 하나 이상 즉시 로딩하는 것은 권장하지 않는다. 기본적으로 [[일대다]] 관계이기 때문에, 너무 많은 데이터를 반환할 수 있고 컬렉션이 2개 이상 조인된다면 반환되는 데이터는 더욱 증가하여 성능 저하가 될 수 있다.
> 2. 컬렉션 즉시 로딩은 항상 [[OUTER JOIN]]을 사용한다.