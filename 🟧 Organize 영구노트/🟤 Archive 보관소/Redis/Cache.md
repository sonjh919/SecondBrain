#Redis 

## Cache
Cache란 한번 조회된 데이터를 **미리 특정 공간에 저장**해놓고, 똑같은 요청이 발생하게 되면 서버에게 다시 요청하지 말고 **저장해놓은 데이터를 제공해서 빠르게 서비스를 제공**해주는 것을 말한다.

> [!note]+ 
> 미리 결과를 저장하고 나중에 요청이 오면 그 요청에 대해서 DB 또는 API를 참조하지 않고 Cache를 접근하여 요청을 처리하는 기법이다.

> [!tip]+ 
> 일반적으로 데이터베이스는 저장장치에 저장이 되는데, 데이터베이스를 조회하려면 저장장치로 i/o가 발생하게 된다. RDBMS에서 SELECT 쿼리문을 날려 특정 데이터들을 FETCH했을 때, RDBMS의 구조상 DISK에서 데이터를 꺼내오는 데 Memory에서 읽어들이는 것보다 천배 가량 더 느리다.
> ![[cache.png]]
> 
## 캐시의 구조 패턴
> [!summary]+ 
> 1. Look aside Cache 패턴
> 2. Write Back 패턴

### Look aside Cache
look aside cache는 캐시를 한 번 접근하여 데이터가 있는지 판단한 후, 있다면 캐시의 데이터를 사용하고 없으면 실제 DB 또는 API를 호출한다.

> [!note]+ 
> 1. 클라이언트에서 데이터를 요청한다.
> 2. 서버에서 캐시에 데이터의 존재 유무를 확인한다.
> 3. 데이터가 있다면 캐시의 데이터를 사용한다.
> 4. 데이터가 없다면 실제 DB 데이터에 접근한다.
> 5. DB에서 가져온 데이터를 캐시에 저장하고 클라이언트에 반환한다.
![[lookaside.png]]

> [!tip]+ 
> + Cache Miss : 메모리에 찾고자 하는 데이터가 없어서 디스크에 조회 할 때
> + Cache Hit : 메모리에 찾고자 하는 데이터가 있을 때


### Write Back
write back은 주로 **쓰기 작업**이 굉장히 많아서, **INSERT 쿼리를 일일이 날리지 않고 한꺼번에 배치 처리**하기 위해 사용한다. write back 기반의 캐시를 사용하면 캐시 메모리에 데이터를 저장해 놓고, 이후 DB 디스크에 업데이트 해 주어 안전하게 쓰기 작업을 이행할 수 있게 할 수 있다.

> [!warning]+ 
> DB에서 디스크를 접근하는 횟수가 줄어들기 때문에 성능 향상을 기대할 수 있지만, DB에 데이터를 저장하기 전에 캐시 서버가 죽으면 데이터가 유실된다는 문제점이 있다.
> 그래서 다시 재생 가능한 데이터나, 극단적으로 heavy 한 데이터에서 write back 방식을 많이 사용한다.

> [!example]+ 
> 로그를 캐시에 저장하고 특정 시점에 DB에 한번에 저장하기

> [!note]+ 
> 1. 우선 모든 데이터를 캐시에 전부 저장한다.
> 2. 캐시의 데이터를 일정 주기마다 DB에 한꺼번에 저장한다. 이는 배치를 이용한다.
> 3. DB에 저장했으니 잔존 데이터는 캐시에서 제거한다.
![[writeback.png]]