#Elasticsearch 

## 심플 타입
심플 타입은 주로 직관적으로 알기 쉬운 간단한 자료형이다. 이 중 [[text와 keyward]] 타입은 매우 중요하기 때문에 따로 분리한다.

### 숫자 타입

| 종류           | 설명                                          |
| ------------ | ------------------------------------------- |
| long         | 64비트 부호 있는 정수                               |
| integer      | 32비트 부호 있는 정수                               |
| short        | 16비트 부호 있는 정수                               |
| byte         | 8비트 부호 있는 정수                                |
| double       | 64비트 부동소수점 수                                |
| float        | 32비트 부동소수점 수                                |
| half_float   | 16비트 부동소수점 수                                |
| scaled_float | double 고정 환산 계수로 스케일링하여 long으로 저장되는 부동소수점 수 |
정수형 데이터를 담는 필드라면 비즈니스 요건이 맞는 범위에서 가장 작은 비트를 사용하는 자료형을 고르면 된다. **작은 비트를 사용하는 자료형을 고르면 색인과 검색 시 이득**이 있다. 하지만 저장할 때는 실제 값에 맞춰 최적화되기 때문에 디스크 사용량에는 이득이 없다.

> [!example]+ 
> scaled_float 타입 사용 시 scaling_factor라는 환산 계수 인자를 지정해야 한다.
> 만약 환산 계수 인자가 100이고 실제 필드 값이 3.943이라면 이를 ES에서는 394라는 정수로 인식한다.
> 
> **정확도에서 손해를 보는 만큼 디스크를 절약**한다고 볼 수 있다.
> 
> 

### date 타입
시간과 관련된 데이터를 편리하게 색인하고 검색하기 위해 도입된 타입이다. ES의 date 타입은 인입되는 데이터의 형식을 format이라는 옵션으로 지정한다. 이는 `java.time.format.DateTimeFormatter`로 인식 가능한  패턴을 사용할 수 있다.

| 종류                        | 설명                                                                                                                   |
| ------------------------- | -------------------------------------------------------------------------------------------------------------------- |
| epoch_millis              | 밀리초 단위로 표현한 epoch 시간                                                                                                 |
| epoch_second              | 초 단위로 표현한 epoch 시간                                                                                                   |
| date_time                 | yyyyMMdd 형태로 표현한 날짜                                                                                                  |
| strict_date_time          | yyyy-MM-dd'T'HH:mm:ss.SSSZZ로 표현한 날짜와 시간                                                                              |
| date_optional_time        | 최소 연 단위의 날짜를 포함해야 하며, 선택적으로 시간 정보도 포함하여 ISO datetime 형태로 표현된 날짜와 시간<br>ex) yyyy-MM-dd 또는 yyyy-MM-dd'T'HH:mm:ss.SSSZZ |
| strict_date_optional_time | date_optional_time과 동일하지만 연, 월, 일이 각각 4자리, 2자리, 2자리임을 보장해야 한다.                                                       |

> [!tip]+ 
> 여러 형식을 허용하도록 지정하려면 여러 format을 `||`문자로 이어붙이면 된다.
> format의 기본값은 `strict_date_optional_time || epoch_millis`이다.

### 배열
ES에는 배열을 표현하는 별도의 타입 구분이 없다.

> [!example]+ 
> long 타입의 필드에는 309라는 단일 숫자 데이터를 넣을 수도 있고, [221, 309, 123] 배열 데이터도 넣을 수 있다.

> [!caution]+ 
> 하지만 여러 타입이 혼합된 배열 데이터의 색인을 요청하는 경우, 색인은 실패한다.

ES에서는 색인 과정에서 데이터가 단일 데이터인지 배열 데이터인지에 상관없이 각 값마다 하나의 독립적인 역색인을 구성하게 된다. 즉, 검색에서 달라지는 점은 없다.
