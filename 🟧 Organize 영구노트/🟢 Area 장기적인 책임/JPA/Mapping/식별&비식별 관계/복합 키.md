#jpa

## 복합 키
JPA에서 복합 키를 사용하려면 별도의 식별자 클래스를 만들어야 한다. 그 후 엔티티에 식별자 클래스를 지정하면 된다.

식별자 클래스를 지정하는 방법은 [[@IdClass]]를 사용하는 방법과 [[@EmbeddedId]]를 사용하는 방법 2가지가 있다. @IdClass는 관계형 데이터베이스에 가까운 방법이고 @EmbeddedId는 객체지향에 가까운 방법이다.

### 식별자 클래스
복합 키를 위한 식별자 클래스는 다음과 같은 특징이 있다.

> [!info]+ 
> + 복합 키는 별도의 식별자 클래스로 만들어야 한다.
> + Serializable을 구현해야 한다.
> + equals와 hashCode 메소드를 구현해야 한다.
> + 기본 생성자가 있어야 한다.
> + 식별자 클래스는 public이어야 한다.


> [!note]+ Serializable
> 데이터를 한 시스템에서 다른 시스템이나 네트워크로 전송하거나 데이터를 파일에 저장할 때, 그 데이터를 전송가능한 형태로 변환해야 한다. 이 작업을 Serializable(직렬화)라고 한다.
> 
> 이 인터페이스를 구현하면 [[JVM]]에서 해당 객체를 저장하거나, 다른 서버로 전송할 수 있게 해 준다.

## @IdClass vs @EmbeddedId
 취향차이에 따라 사용하면 된다. 굳이 구분하자면, 엔티티 구조가 단순하고 기본 키 클래스가 엔티티 내부에서만 사용되는 경우 @EmbeddedId, 구조가 복잡하거나 복합 키의 재사용성이 높은 경우는 @IdClass를 사용하는 것이 좋다. 

@EmbeddedId가 더 객체지향적이고 중복도 없어서 괜찮을 것 같지만, 특정 상황에 [[JPQL]]이 조금 더 길어질 수는 있다.