#jpa 

## 지연 로딩
엔티티를 조회할 때 연관된 엔티티들이 항상 사용되는 것은 아니다. JPA는 이런 문제를 해결하기 위해 **엔티티가 실제 사용될 때 까지 데이터베이스 조회를 지연**하는 방법을 제공하는데, 이것을 지연 로딩이라고 한다. 지연 로딩 기능을 사용하기 위해 [[프록시]]를 사용한다.

> [!example]+ 
> team.getName() 처럼 team 엔티티의 값을 실제 사용하는 시점에 데이터베이스에서 필요한 데이터를 조회한다.

+ [[@ManyToOne]]의 fetch 속성을 이용한다.

> [!note]+ 지연 로딩
> @ManyToOne(fetch = FetchType.LAZY)


## JPA 기본 fetch 전략
fetch 속성의 기본 설정값은 다음과 같다.

> [!info]+ 
> @ManyToOne, @OneToOne : 즉시 로딩(EAGER)
> @OneToMany, @ManyToMany : 지연 로딩(LAZY)

JPA의 기본 fetch 전략은 연관된 엔티티가 하나면 [[즉시 로딩]]을, 컬렉션이면 지연 로딩을 사용한다. 하지만 기본 전략을 반드시 따라갈 필요는 없다.

> [!tip]+ 
> 모든 연관관계에 지연 로딩을 사용한 후, 개발이 완료단계에 왔을 때 실제 사용하는 상황을 보고 꼭 필요한 곳에만 즉시 로딩을 사용하도록 최적화하자.
> 
> SQL을 직접 사용할 경우 이런 방식의 유연한 최적화가 어렵다.