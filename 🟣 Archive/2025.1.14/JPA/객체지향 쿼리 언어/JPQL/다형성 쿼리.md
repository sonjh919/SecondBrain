#jpa #JPQL


## ë‹¤í˜•ì„± ì¿¼ë¦¬
JPQLë¡œ ë¶€ëª¨ ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•˜ë©´ ê·¸ ìžì‹ ì—”í‹°í‹°ë„ í•¨ê»˜ ì¡°íšŒí•œë‹¤.

```java
List resultList = em.createQuery("select i from Item i").getResultList();
```

### [[ë‹¨ì¼ í…Œì´ë¸” ì „ëžµ]]
ë‹¨ì¼ í…Œì´ë¸” ì „ëžµ(InheritanceType.SINGLE_TABLE)ì„ ì‚¬ìš©í•  ë•Œ ì‹¤í–‰ë˜ëŠ” SQLì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

```sql
SELECT * FROM ITEM
```

### [[ì¡°ì¸ ì „ëžµ]]
ë‹¨ì¼ í…Œì´ë¸” ì „ëžµ(InheritanceType.JOINED)ì„ ì‚¬ìš©í•  ë•Œ ì‹¤í–‰ë˜ëŠ” SQLì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

```sql
SELECT
	i.ITEM_ID, i.DTYPE, i.name, i.price, i.stockQuantity,
	b.author, b.isbn,
	a.artist, a.etc,
	m.actor, m.director
FROM
	Item i
LEFT OUTER JOIN
	Book b on i.ITEM_ID=b.ITEM_ID
LEFT OUTER JOIN
	Album a on i.ITEM_ID=a.ITEM_ID
LEFT OUTER JOIN
	Movie m on iITEM_ID=m.ITEM_ID

```

## TYPE
TYPEì€ ì—”í‹°í‹°ì˜ ìƒì† êµ¬ì¡°ì—ì„œ **ì¡°íšŒ ëŒ€ìƒì„ íŠ¹ì • ìžì‹ íƒ€ìž…ìœ¼ë¡œ í•œì •**í•  ë•Œ ì£¼ë¡œ ì‚¬ìš©í•œë‹¤.

> [!example]+ 
> + Item ì¤‘ì— Book, Movieë§Œ ì¡°íšŒí•˜ê¸°
> ```sql
> --JPQL
> SELECT i FROM Item i
> where type(i) IN (Book, Movie)
> 
> --SQL
> SELECT i FROM ITEM i
> WHERE i.DTYPE in ('B', 'M')
> ```

## TREAT
TREATëŠ” JPA 2.1ì— ì¶”ê°€ëœ ê¸°ëŠ¥ìœ¼ë¡œ, ìžë°”ì˜ íƒ€ìž… ìºìŠ¤íŒ…([[ðŸŸ  Project/JAVA/ê¸°ë³¸ ë¬¸ë²•/í˜• ë³€í™˜|í˜• ë³€í™˜]])ê³¼ ë¹„ìŠ·í•˜ë‹¤. ìƒì† êµ¬ì¡°ì—ì„œ **ë¶€ëª¨ íƒ€ìž…ì„ íŠ¹ì • ìžì‹ íƒ€ìž…ìœ¼ë¡œ ë‹¤ë£° ë•Œ ì‚¬ìš©**í•œë‹¤.

> [!info]+ 
> JPA í‘œì¤€ì€ FROM, WHERE ì ˆì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìžˆì§€ë§Œ, í•˜ì´ë²„ë„¤ì´íŠ¸ëŠ” SELECTì ˆì—ì„œë„ TREATë¥¼ ì‚¬ìš©í•  ìˆ˜ ìžˆë‹¤.

> [!example]+ 
> + ë¶€ëª¨ íƒ€ìž…ì¸ Itemì„ ìžì‹ íƒ€ìž…ì¸ Bookìœ¼ë¡œ ë‹¤ë£¨ê¸°
> ```sql
> --JPQL
> SELECT i FROM Item i WHERE treat(i as Book).author = 'kim'
> 
> --SQL
> SELECT i.* FROM Item i
> WHERE
> 	i.DTYPE='B'
> 	and i.author='kim'
> ```