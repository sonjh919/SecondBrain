---
title: 쿠키와 세션 기반 인증
date: 2024-01-24 11:42
categories:
  - Spring
  - Security
tags:
  - Spring
  - Security
image: 
path:
---

## 쿠키와 세션 기반 인증
쿠키와 세션 모두 [[HTTP]]에 상태 정보를 유지(Stateful)하기 위해 사용된다. 즉, 쿠키와 세션을 통해 서버에서는 클라이언트 별로 [[인증과 인가]]를 할 수 있게 된다.

쿠키-세션 방식은 서버가 ‘특정 유저가 로그인 되었다’는 상태를 저장하는 방식이다. 인증과 관련된 아주 약간의 정보만 서버가 가지고 있게 되고 유저의 이전 상태의 전부는 아니더라도 **인증과 관련된 최소한의 정보는 저장해서 로그인을 유지시킨다**는 개념이다.

### 인증 절차
1. 사용자가 로그인 요청을 보낸다.
2. 서버는 DB의 유저 테이블을 뒤져서 아이디 비밀번호를 대조한다.
3. 실제 유저테이블의 정보와 일치한다면 인증을 통과한 것으로 보고 “**세션 저장소**”에 해당 유저가 로그인 되었다는 정보를 넣는다.
4. 세션 저장소에서는 유저의 정보와는 관련 없는 난수인 **session-id를 발급**한다.
5. 서버는 로그인 요청의 응답으로 session-id를 내어준다.
6. **클라이언트는 그 session-id를 쿠키라는 저장소에 보관**하고 앞으로의 요청마다 세션아이디를 같이 보낸다. (주로 [[HTTP headers]]에 담아서 보낸다!)
7. 클라이언트의 요청에서 쿠키를 발견했다면 서버는 세션 저장소에서 쿠키를 검증한다.
8. 만약 유저정보를 받아왔다면 이 사용자는 로그인이 되어있는 사용자임을 확인할 수 있다.
9. 이후에는 로그인 된 유저에 따른 응답을 내어준다.

![[cookiesession.jpeg]]